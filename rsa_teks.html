<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<title>RSA Cipher - Teks</title>
<style>
body { font-family: Arial; padding: 20px; }
input, textarea, button { width: 100%; margin: 6px 0; }
</style>
</head>

<body>

<h2>RSA Cipher (Teks)</h2>

<label>Bilangan Prima p:</label>
<input type="number" id="p" value="61">

<label>Bilangan Prima q:</label>
<input type="number" id="q" value="53">

<label>Plaintext (Huruf Kapital):</label>
<textarea id="text"></textarea>

<button onclick="proses()">Proses Enkripsi</button>

<h3>Hasil Ciphertext:</h3>
<p id="hasil"></p>

<script>
function modPow(base, exp, mod) {
    let hasil = 1n;
    base = BigInt(base) % BigInt(mod);
    while (exp > 0n) {
        if (exp % 2n === 1n) hasil = (hasil * base) % mod;
        exp = exp / 2n;
        base = (base * base) % mod;
    }
    return hasil;
}

function proses() {
    let p = BigInt(document.getElementById("p").value);
    let q = BigInt(document.getElementById("q").value);
    let text = document.getElementById("text").value.toUpperCase();

    let n = p * q;
    let e = 7n;
    let hasil = [];

    for (let huruf of text) {
        if (huruf < 'A' || huruf > 'Z') continue;
        let m = BigInt(huruf.charCodeAt(0) - 64);
        let c = modPow(m, e, n);
        hasil.push(c.toString());
    }

    document.getElementById("hasil").innerText = hasil.join(" ");
}
</script>

</body>
</html>
